{"version":3,"sources":["../../../src/plugins/Dashboard/FileCard.js"],"names":["getFileTypeIcon","require","FilePreview","h","Component","module","exports","props","meta","tempStoreMetaOrSubmit","bind","renderMetaFields","handleSave","handleCancel","ev","file","files","fileCardFor","keyCode","stopPropagation","preventDefault","saveFileCard","id","value","target","name","dataset","me","metaFields","forEach","field","selected","type","push","e","checked","console","log","placeholder","fileID","toggleFileCard","render","width","height","i18nArray","i18n","backgroundColor","color"],"mappings":"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","file":"FileCard.js","sourcesContent":["const getFileTypeIcon = require('./getFileTypeIcon')\nconst FilePreview = require('./FilePreview')\nconst { h, Component } = require('preact')\n\nmodule.exports = class FileCard extends Component {\n  constructor (props) {\n    super(props)\n\n    this.meta = {}\n\n    this.tempStoreMetaOrSubmit = this.tempStoreMetaOrSubmit.bind(this)\n    this.renderMetaFields = this.renderMetaFields.bind(this)\n    this.handleSave = this.handleSave.bind(this)\n    this.handleCancel = this.handleCancel.bind(this)\n  }\n\n  tempStoreMetaOrSubmit (ev) {\n    const file = this.props.files[this.props.fileCardFor]\n\n    if (ev.keyCode === 13) {\n      ev.stopPropagation()\n      ev.preventDefault()\n      this.props.saveFileCard(this.meta, file.id)\n      return\n    }\n\n    const value = ev.target.value\n    const name = ev.target.dataset.name\n    this.meta[name] = value\n  }\n\n  renderMetaFields (file) {\n    let meta = []\n    let me = this\n    let metaFields = this.props.metaFields || []\n\n    metaFields.forEach((field) => {\n      let selected = file.meta[field.id]\n      if (field.type === 'toggle') {\n        meta.push(<div class=\"uppy-DashboardFileCard-fieldset uppy-toggle-field\">\n          <div className={'uppy-toggle-label'}>\n            <label class=\"uppy-DashboardFileCard-label\">{field.name}</label>\n          </div>\n          <div className={'uppy-toggle'}>\n            {selected\n            ? <input type=\"checkbox\" id={field.id}\n              onClick={(e) => {\n                me.meta[field.id] = e.target.checked\n              }}\n              checked />\n              : <input type=\"checkbox\" id={field.id}\n                onClick={(e) => {\n                  console.log(file)\n                  me.meta[field.id] = e.target.checked\n                }}\n              />\n            }\n            <label for={field.id}>Toggle</label>\n          </div>\n        </div>)\n      } else {\n        meta.push(<fieldset class=\"uppy-DashboardFileCard-fieldset\">\n          <label class=\"uppy-DashboardFileCard-label\">{field.name}</label>\n          <input class=\"uppy-c-textInput uppy-DashboardFileCard-input\"\n            type=\"text\"\n            data-name={field.id}\n            value={file.meta[field.id]}\n            placeholder={field.placeholder}\n            onkeyup={this.tempStoreMetaOrSubmit}\n            onkeydown={this.tempStoreMetaOrSubmit}\n            onkeypress={this.tempStoreMetaOrSubmit} /></fieldset>)\n      }\n    })\n    return meta\n  }\n\n  handleSave (ev) {\n    const fileID = this.props.fileCardFor\n    this.props.saveFileCard(this.meta, fileID)\n  }\n\n  handleCancel (ev) {\n    this.meta = {}\n    this.props.toggleFileCard()\n  }\n\n  render () {\n    if (!this.props.fileCardFor) {\n      return <div class=\"uppy-DashboardFileCard\" aria-hidden />\n    }\n\n    const file = this.props.files[this.props.fileCardFor]\n\n    return (\n      <div class=\"uppy-DashboardFileCard\" aria-hidden={!this.props.fileCardFor}>\n        <div style={{ width: '100%', height: '100%' }}>\n          <div class=\"uppy-DashboardContent-bar\">\n            <div class=\"uppy-DashboardContent-title\" role=\"heading\" aria-level=\"h1\">\n              {this.props.i18nArray('editing', {\n                file: <span class=\"uppy-DashboardContent-titleFile\">{file.meta ? file.meta.name : file.name}</span>\n              })}\n            </div>\n            <button class=\"uppy-DashboardContent-back\" type=\"button\" title={this.props.i18n('finishEditingFile')}\n              onclick={this.handleSave}>{this.props.i18n('done')}</button>\n          </div>\n\n          <div class=\"uppy-DashboardFileCard-inner\">\n            <div class=\"uppy-DashboardFileCard-preview\" style={{ backgroundColor: getFileTypeIcon(file.type).color }}>\n              <FilePreview file={file} />\n            </div>\n\n            <div class=\"uppy-DashboardFileCard-info\">\n              {this.renderMetaFields(file)}\n            </div>\n\n            <div class=\"uppy-Dashboard-actions\">\n              <button class=\"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-actionsBtn\"\n                type=\"button\"\n                onclick={this.handleSave}>{this.props.i18n('saveChanges')}</button>\n              <button class=\"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-actionsBtn\"\n                type=\"button\"\n                onclick={this.handleCancel}>{this.props.i18n('cancel')}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n"]}